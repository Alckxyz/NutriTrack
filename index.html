<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriTrack - Contador de Calor√≠as y Nutrientes</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="styles-ui.css">
    <link rel="stylesheet" href="styles-meals.css">
    <link rel="stylesheet" href="styles-modals.css">
    <link rel="stylesheet" href="styles-responsive.css">
    <script type="importmap">
        {
          "imports": {
            "sortablejs": "https://esm.sh/sortablejs@1.15.2",
            "chart.js": "https://esm.sh/chart.js@4.4.1",
            "firebase/app": "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js",
            "firebase/auth": "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js",
            "firebase/database": "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js"
          }
        }
    </script>
</head>
<body>
    <header>
        <div class="header-left">
            <div class="logo-container">
                <img src="icon_logo.png" alt="NutriTrack Logo" class="logo">
                <h1>NutriTrack</h1>
            </div>
            <nav class="main-nav">
                <button id="nav-calories-btn" class="nav-btn active" data-t="nav_calories">Calor√≠as</button>
                <button id="nav-exercises-btn" class="nav-btn" data-t="nav_exercises">Ejercicios</button>
            </nav>
        </div>
        <div class="header-actions">
            <div id="calories-tools" class="header-tools-group">
                <button id="manage-db-btn" class="secondary-btn" data-t="manage_db">üçé Food List</button>
                <button id="manage-recipes-btn" class="secondary-btn" data-t="manage_recipes">üìñ Recipes</button>
                <button id="weight-btn" class="secondary-btn" data-t="weight_btn">‚öñÔ∏è Peso</button>
                <button id="settings-btn" class="secondary-btn" title="Settings" data-t="settings_btn">‚öôÔ∏è Settings</button>
            </div>
            <div id="exercises-tools" class="header-tools-group hidden">
                <button id="exercise-settings-btn" class="secondary-btn" title="Ajustes de Entrenamiento" data-t="exercise_settings_btn">‚öôÔ∏è Ajustes</button>
            </div>
            <div id="user-profile" class="hidden" style="position: relative; cursor: pointer;">
                <img id="user-avatar" src="" alt="Avatar" style="width: 32px; height: 32px; border-radius: 50%; display: block;">
                <div id="logout-dropdown" class="hidden" style="position: absolute; top: calc(100% + 10px); right: 0; background: var(--card-bg); border: 1px solid var(--border); box-shadow: var(--shadow); border-radius: 8px; min-width: 100px; padding: 4px; z-index: 1000;">
                    <button id="logout-btn" class="secondary-btn" style="width: 100%; text-align: left; padding: 8px 12px; font-size: 0.85rem;">Logout</button>
                </div>
            </div>
            <button id="login-btn" class="primary-btn">Login with Google</button>
            <input type="file" id="file-input" style="display: none;">
        </div>
    </header>

    <main>
        <section id="calories-view">
        <section class="summary-card">
            <div id="weight-reminder" class="hidden" style="background: rgba(100, 181, 246, 0.1); border: 1px solid var(--secondary); padding: 8px; border-radius: 8px; margin-bottom: 1rem; font-size: 0.85rem; display: flex; justify-content: space-between; align-items: center;">
                <span data-t="weight_reminder_text">¬øQuieres actualizar tu peso? Han pasado m√°s de 7 d√≠as.</span>
                <button id="reminder-weight-btn" class="add-mini-btn" style="border-color: var(--secondary); color: var(--secondary);">+ Registrar</button>
            </div>
            <h2 data-t="daily_summary">Daily Summary</h2>
            <div class="stats-grid">
                <div class="stat-item" id="stat-calories">
                    <span class="label" data-t="calories">Calories</span>
                    <span class="value">0</span>
                    <span class="unit">kcal</span>
                </div>
                <div class="stat-item" id="stat-protein">
                    <span class="label" data-t="protein">Protein</span>
                    <span class="value">0</span>
                    <span class="unit">g</span>
                </div>
                <div class="stat-item" id="stat-carbs">
                    <span class="label" data-t="carbs">Carbs</span>
                    <span class="value">0</span>
                    <span class="unit">g</span>
                </div>
                <div class="stat-item" id="stat-fat">
                    <span class="label" data-t="fat">Fat</span>
                    <span class="value">0</span>
                    <span class="unit">g</span>
                </div>
                <div class="stat-item" id="stat-fiber">
                    <span class="label" data-t="fiber">Fibra</span>
                    <span class="value">0</span>
                    <span class="unit">g</span>
                </div>
            </div>
            <div class="micros-summary" id="total-micros">
                <!-- Vitamins and minerals totals here -->
            </div>
        </section>

        <section class="planner-container">
            <div class="section-header">
                <div class="planner-title-area">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <h2 id="planner-title" data-t="meals">Meals</h2>
                        <div id="standard-plans-selector-container" class="hidden">
                            <select id="standard-plan-select" class="settings-select" style="padding: 4px 8px; font-size: 0.85rem; width: auto; min-width: 140px;"></select>
                            <button id="manage-standard-plans-btn" class="edit-btn-mini" title="Gestionar planes" style="padding: 4px 8px;">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div id="date-picker-container" class="date-picker-container hidden">
                        <div class="date-picker-controls">
                            <button id="prev-day-btn" class="secondary-btn" title="Previous Day">&larr;</button>
                            <input type="date" id="plan-date-picker">
                            <button id="next-day-btn" class="secondary-btn" title="Next Day">&rarr;</button>
                        </div>
                        <span id="day-name-display"></span>
                    </div>
                </div>
                <button id="add-meal-btn" class="add-btn" data-t="add_meal">+ Add Meal</button>
            </div>
            <div id="meals-list" class="meals-list">
                <!-- Meals will be injected here -->
            </div>
        </section>
        </section>

        <section id="exercises-view" class="hidden">
            <div class="section-header" style="flex-wrap: wrap; gap: 12px; align-items: center;">
                <div style="display: flex; align-items: center; gap: 12px; flex-wrap: wrap;">
                    <h2 data-t="routines_title" style="margin-bottom: 0;">Mis Rutinas</h2>
                    <div id="exercise-plan-selector-container" style="display: flex; align-items: center; gap: 6px;">
                        <select id="exercise-plan-select" class="settings-select" style="padding: 6px 10px; font-size: 0.9rem; width: auto; min-width: 140px; height: 38px; border-color: var(--primary);"></select>
                        <button id="manage-exercise-plans-btn" class="edit-btn-mini" title="Gestionar planes" style="padding: 6px 10px; height: 38px;">‚öôÔ∏è</button>
                    </div>
                    <div id="routine-selector-container" class="hidden" style="display: flex; align-items: center; gap: 6px;">
                        <select id="routine-select" class="settings-select" style="padding: 6px 10px; font-size: 0.9rem; width: auto; min-width: 160px; height: 38px;"></select>
                        <button id="manage-routines-btn" class="edit-btn-mini" title="Gestionar rutinas" style="padding: 6px 10px; height: 38px;">‚öôÔ∏è</button>
                    </div>
                </div>
                <button id="add-routine-btn" class="add-btn" data-t="add_routine">+ Nueva Rutina</button>
            </div>
            
            <div id="routines-list" class="routines-list">
                <!-- Routines will be injected here -->
            </div>

            <!-- Rest Timer Floating UI -->
            <div id="rest-timer-ui" class="rest-timer-ui hidden">
                <div class="timer-content">
                    <div class="timer-label" id="timer-type-label">Descanso</div>
                    <div class="timer-display" id="timer-display">00:00</div>
                    <div class="timer-controls">
                        <button id="timer-toggle-btn" class="timer-btn">‚ñ∂</button>
                        <button id="timer-reset-btn" class="timer-btn">‚Ü∫</button>
                        <button id="timer-close-btn" class="timer-btn">√ó</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modals Container: All modals are injected via modals-html.js to keep index.html clean -->
    <div id="modals-outlet"></div>

    <div class="fab-container">
        <button id="open-db-modal" class="fab" title="Add Food to List">+</button>
    </div>

    <!-- Datalists for micronutrient name suggestions -->
    <datalist id="vitamin-suggestions"></datalist>
    <datalist id="mineral-suggestions"></datalist>

    <script type="module" src="script.js"></script>
</body>
</html>